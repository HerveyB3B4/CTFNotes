# 0329CTF通识课复盘

## 1-tail

hint其实就在题目里...

用 010Editor 打开图片，flag 就在文件尾

## 2-goose

考点: Exif 隐写

`右键 >> 属性 >> 详细信息` 可以看到 flag 在 `来源 > 作者` 栏

## 3-lsb

考点: lsb 隐写

使用工具: StegSolve.jar

```shell
java -jar Stegsolve.jar
```

使用StegSolve打开 `1_lsb.png` 文件， `Analyse > Data Extract` ，勾选 `Red 0` , `Green 0` , `Blue 0` , `LSB First` 点击 `Preview` 获得 flag

## 4-polar-light

考点: png 长宽爆破

使用 010Editor 获得 png 文件的 CRC 校验码

使用如下脚本爆破 png 文件的真实长宽

```python
import os
import binascii
import struct

#文件名
filename = "4.png"
#图片当前CRC(29-32位)
CRC = 0x2EE0E28E

crcbp = open(filename, "rb").read()
for i in range(2000):
    for j in range(2000):
        data = crcbp[12:16] + \
            struct.pack('>i', i)+struct.pack('>i', j)+crcbp[24:29]
        crc32 = binascii.crc32(data) & 0xffffffff
        if (crc32 == CRC):
            print(i, j)
            print('hex:', hex(i), hex(j))
```

得到png的真实尺寸

```shell
┌──(hervey㉿Hervey)-[/mnt/c/Users/hervey/Downloads]
└─$ python3 ./calc_pic_size.py
952 490
hex: 0x3b8 0x1ea
```

替换掉原来的长宽值后打开图片即可获得 flag

## 5-spring

使用 010Editor 打开文件，观察后发现文件倒置了

使用如下脚本还原 png 文件

```python
with open('5.png', 'rb') as f:
    with open('real.png', 'wb') as g:
        g.write(f.read()[::-1])
```

打开还原后的图片即可获得 flag

## 6-bridge

使用 010 Editor 打开 `6.png` 发现后面有一段"冗余"内容

binwalk 一下看看

```shell
┌──(hervey㉿Hervey)-[/mnt/c/Users/hervey/Downloads/6]
└─$ binwalk ./6.jpg

DECIMAL       HEXADECIMAL     DESCRIPTION
--------------------------------------------------------------------------------
0             0x0             JPEG image data, JFIF standard 1.02
30            0x1E            TIFF image data, big-endian, offset of first image directory: 8
332           0x14C           JPEG image data, JFIF standard 1.02
9499          0x251B          JPEG image data, JFIF standard 1.02
21682         0x54B2          Copyright string: "Copyright (c) 1998 Hewlett-Packard Company"
809662        0xC5ABE         JPEG image data, JFIF standard 1.02
809692        0xC5ADC         TIFF image data, big-endian, offset of first image directory: 8
809994        0xC5C0A         JPEG image data, JFIF standard 1.02
817885        0xC7ADD         JPEG image data, JFIF standard 1.02
828791        0xCA577         Copyright string: "Copyright (c) 1998 Hewlett-Packard Company"
```

可以发现在 jpg 文件后还藏了一个 jpg 文件

使用 foremost 命令分离文件

```shell
┌──(hervey㉿Hervey)-[/mnt/c/Users/hervey/Downloads/6]
└─$ foremost ./6.jpg
Processing: ./6.jpg
|*|
```

从分离出的图片中可获得 flag

## 7-nopassword

考察内容: zip伪加密

使用工具~~偷懒工具~~: 7zip

~~直接用 7zip 解压即可~~

修改 5D 位的 `09` 为 `00` 即可无密码进行解压得到 `flag.txt` ，进而获得 flag

## 8-birthday

考察内容: zip密码爆破

根据题目提示可猜测密码是数字(但是不确定几位)，使用 John 进行爆破

```shell
┌──(hervey㉿Hervey)-[/mnt/c/Users/hervey/Downloads]
└─$ zip2john 8.zip > 8.hash

┌──(hervey㉿Hervey)-[/mnt/c/Users/hervey/Downloads]
└─$ john 8.hash
Using default input encoding: UTF-8
Loaded 1 password hash (ZIP, WinZip [PBKDF2-SHA1 512/512 AVX512BW 16x])
Cost 1 (HMAC size) is 47 for all loaded hashes
Will run 16 OpenMP threads
Proceeding with single, rules:Single
Press 'q' or Ctrl-C to abort, almost any other key for status
Almost done: Processing the remaining buffered candidate passwords, if any.
Proceeding with wordlist:/usr/share/john/password.lst
Proceeding with incremental:ASCII
040508           (8.zip/flag.txt)
1g 0:00:00:01 DONE 3/3 (2024-04-07 00:02) 0.8333g/s 314803p/s 314803c/s 314803C/s batow1..mcfars
Use the "--show" option to display all of the cracked passwords reliably
Session completed.
```

得到密码为 `040508`

解压后打开 `flag.txt` 即可获得 flag

## 9-manyzip

解压文件后可以发现有很多 zip 文件，每个文件里都有一个 txt 文件，尝试使用如下脚本解压文件

```bash
for file in *.zip; do
    unzip "$file" -d .
done
```

然后使用 `strings` 命令寻找 flag

```shell
┌──(hervey㉿Hervey)-[/mnt/c/Users/hervey/Downloads/manyzip]
└─$ strings *.txt | grep Stinger
Stinger{dfc2e6b5-9f14-4321-a961-2ef0e756d3b7}
```

## 10-baseXX

打开 txt 文件，发现这样一段文字

```plain
;fl_kB4Z+11G^q!2Ig;Q/Mpur1bCO=2E!-I@Q-+q2.L&P2`<L&0k<$qI/
```

使用 Base85 解码获得 flag

## 11-baseN顾

打开 txt 文件，发现这样一段文字

```plain
Vm0xNFUxUXhWWGxVYTJoVVlteEthRlZxVG05alZteDBUbFU1VDFKc1NucFdWM014WVRBeFdHVklhRnBXUlRVelZqSjRWMDVzU25WUmJHaFlVMFZLYUZaR1VrTk9SbHBYVm01U2ExSXdXbGhWYkdRelpERlplRmt6YUZSaGVsWlhWRlpvUTFSc1dYcFJhemxoVmpOb00xa3dXbE5YUlRGWFkwVTFWMVpGV2pSV2JYaFRVakZSZUZOclpGaFdSbFU1
```

使用 Base64 连续解码 6 次获得 flag
